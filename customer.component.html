<div class="container-fluid">
  <div class="card">
    <div class="card-header">
      <div class="d-flex justify-content-between">
        <div class="d-flex">
          <h1 class="pageTitle inline me-3">Customers</h1>
          <input type="text" class="form-control search-input" placeholder="Search..." [(ngModel)]="searchQuery"
            (input)="filterCustomers()">
        </div>
        <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="offcanvas" data-bs-target="#addCustomer"
          (click)="prepareModal()">
          Add Customer
        </button>
      </div>
    </div>
    <div class="table-responsive divTable">
      <table id="example" class="table table-hover mb-0 no-footer">
        <thead>
          <tr>
            <th (click)="sortData('customerName')">
              Customer Name
              <span class="sort-indicator">
                <span [ngClass]="getSortArrowClass('customerName', 'asc')">&uarr;</span>
                <span [ngClass]="getSortArrowClass('customerName', 'desc')">&darr;</span>
              </span>
            </th>
            <th (click)="sortData('mobileNumber')">
              Contact
              <span class="sort-indicator">
                <span [ngClass]="getSortArrowClass('mobileNumber', 'asc')">&uarr;</span>
                <span [ngClass]="getSortArrowClass('mobileNumber', 'desc')">&darr;</span>
              </span>
            </th>
            <th (click)="sortData('emailID')">
              Email
              <span class="sort-indicator">
                <span [ngClass]="getSortArrowClass('emailID', 'asc')">&uarr;</span>
                <span [ngClass]="getSortArrowClass('emailID', 'desc')">&darr;</span>
              </span>
            </th>
            <th (click)="sortData('address')">
              Address
              <span class="sort-indicator">
                <span [ngClass]="getSortArrowClass('address', 'asc')">&uarr;</span>
                <span [ngClass]="getSortArrowClass('address', 'desc')">&darr;</span>
              </span>
            </th>

            <th>
              Status
            </th>
            <th class="sorting" tabindex="0" aria-controls="example" rowspan="1" colspan="1"
              aria-label="Action: activate to sort column ascending">Action
            </th>
          </tr>
        </thead>
        <tbody>
          <ng-container>
            <!-- @for (customer of allCustomers; track $index) { -->
            <!-- <tr *ngFor="let customer of filteredCustomers; let i = index" [ngClass]="{'odd': i % 2 !== 0}"> -->
            <tr *ngFor="let customer of filteredCustomers | paginate: { itemsPerPage: 10, currentPage: currentPage }">
              <!-- <td>{{customer.customerID}}</td> -->
              <td>{{customer.customerName}}</td>
              <td>
                <span *ngIf="getPrimaryContacts(customer.pointOfContacts).length > 0">
                  <span *ngFor="let poc of getPrimaryContacts(customer.pointOfContacts); let last = last">
                    {{ poc.mobileNumber }}<span *ngIf="!last">, </span>
                  </span>
                </span>
                <span *ngIf="getPrimaryContacts(customer.pointOfContacts).length === 0">No Data</span>
              </td>

              <td>
                <span *ngIf="getPrimaryContacts(customer.pointOfContacts).length > 0">
                  <span *ngFor="let poc of getPrimaryContacts(customer.pointOfContacts); let last = last">
                    {{ poc.emailID }}<span *ngIf="!last">, </span>
                  </span>
                </span>
                <span *ngIf="getPrimaryContacts(customer.pointOfContacts).length === 0">No Data</span>
              </td>

              <td>{{customer.address}}</td>
              <td>
                <span class="me-3 form-switch">
                  <input class="form-check-input" type="checkbox" id="toggleEnabled{{customer.customerID}}"
                    [checked]="customer.isEnabled" [ngClass]="{'toggle-circle-enabled': customer.isEnabled, 
                                                                      'toggle-circle-disabled': !customer.isEnabled}"
                    (click)="openUserStatusUpdateConfirmationModal(customer, $event)" />
                </span>
              </td>
              <td>
                <a href="" class="me-3 text-dark view-details-icon" data-bs-toggle="offcanvas"
                  data-bs-target="#user-details-modal">
                  <span class="material-symbols-outlined" (click)="CustomerDetailsByID(customer.customerID)"
                    data-toggle="tooltip" title="View Customer Details" (contextmenu)="disableRightClick($event)">
                    visibility
                  </span>
                </a>
                <a href="" class="me-3" data-bs-toggle="offcanvas" data-bs-target="#addCustomer">
                  <span class="material-symbols-outlined" data-toggle="tooltip" title="Edit Customer"
                    (click)="editCustomer(customer)" (contextmenu)="disableRightClick($event)">edit_square</span></a>
                <a href="#" class="me-3 text-danger" data-bs-toggle="modal" data-bs-target="#delete-popup"
                  (click)="selectCustomerForDeletion(customer)" title="Delete Customer" (contextmenu)="disableRightClick($event)"><i
                    class="material-symbols-outlined text-danger">delete</i></a>
                <!-- <span class="form-check-inline form-switch"> <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" [checked]="customer.isActive" (change)="onToggleChange(customer, $event)"></span> -->
              </td>
            </tr>
            <!-- }@empty { -->
            <tr *ngIf="filteredCustomers.length === 0">
              <td colspan="6" class="text-center">
                <div class="NoRecords">No Records to Display.</div>
              </td>
            </tr>
            <!-- } -->
          </ng-container>
        </tbody>
      </table>
      <div class="pagination-container">
        <div class="record-info">
          {{ recordsRange }}
        </div>
        <pagination-controls (pageChange)="currentPage = $event" [directionLinks]="true" previousLabel="" nextLabel="">
        </pagination-controls>

      </div>
    </div>
  </div>


  <!-- Add Customer Modal -->
  <div class="offcanvas offcanvas-end w-80 fade" id="addCustomer" tabindex="-1" aria-labelledby="exampleModalLabel"
    data-bs-backdrop="static" data-bs-keyboard="false" aria-hidden="true">
    <div class="offcanvas-header">
      @if(selectedCustomer){
      <h5 class="offcanvas-title mx-3" id="exampleModalLabel">Edit Customer</h5>
      }@else{
      <h5 class="offcanvas-title mx-3" id="exampleModalLabel">Add a New Customer</h5>
      }
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"
        (click)="disableTransportAndPackingTabOnCancel()" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body nofooter">
      <form [formGroup]="form" (ngSubmit)="validate()">
        <ul class="nav nav-pills mb-4 nav-fill" role="tablist">
          <li class="nav-item waves-effect waves-light" role="presentation">
            <a class="nav-link active" (click)="setActiveTab(1)" [class.active]="activeTab === 1"> Customer Details</a>
          </li>
          <li class="nav-item waves-effect waves-light" role="presentation">
            <a class="nav-link" (click)="setActiveTab(2)" [class.active]="activeTab === 2">Address Book</a>
          </li>
          <li class="nav-item waves-effect waves-light" role="presentation">
            <a class="nav-link" [class.disabled]="disableTransportAndPackingTab" (click)="loadCustomerAddresses()"
              [class.active]="activeTab === 3">Transport & Packing</a>
          </li>
          <!-- <li class="nav-item waves-effect waves-light" role="presentation">
            <a class="nav-link" (click)="setActiveTab(3);loadCustomerAddresses()"  [class.active]="activeTab === 3">Transport & Packing</a>
          </li> -->
        </ul>

        <!-- Tab 1: Customer and Point of Contact -->
        <div *ngIf="activeTab === 1">
          <div formGroupName="customerInfo" class="">
            <fieldset>
              <legend>Details </legend>
              <div class="row">
                <div class="col-sm-4 mb-3">
                  <div class="d-flex justify-content-between">
                    <label class="form-text" for="customerName">Customer Name: <span class="required">*</span></label>
                    @if (form.get('customerInfo.customerName')?.invalid &&
                    form.get('customerInfo.customerName')?.touched) {
                    <div class="text-danger">
                      <small>Required.</small>
                    </div>
                    }
                  </div>
                  <input formControlName="customerName" type="text" class="form-control" (input)="sanitizeInput('customerName')"
                  (keydown)="preventMultipleSpaces($event, 'customerName')"
                  (paste)="handlePaste($event, 'customerName')" />
                </div>
                <div class="col-sm-4 mb-3">
                  <div class="d-flex justify-content-between">
                    <label class="form-text" for="customerTypes">Customer Type:<span class="required">*</span></label>
                    @if(customerTypesValidationFlag)
                    {
                    <div class="text-danger">
                      <small>Required.</small>
                    </div>
                    }
                  </div>
                  <ng-multiselect-dropdown [placeholder]="'Select Customer Type'"
                    [settings]="customerTypesDropdownSettings" [data]="allCustomerTypes" formControlName="customerTypes"
                    id="customerTypeIDs" name="customerTypeIDs" required (onSelect)="onCustomerTypesSelect($event, 0)"
                    (onDeSelect)="onCustomerTypesDeSelect()">
                  </ng-multiselect-dropdown>
                </div>
                <div class="col-sm-4 mb-3">
                  <div class="d-flex justify-content-between">
                    <label class="form-text" for="paymentTerms">Payment Terms:<span class="required">*</span></label>
                    @if(paymentTermsValidationFlag){
                    <div class="text-danger">
                      <small>Required.</small>
                    </div>
                    }
                  </div>
                  <div class="d-flex justify-content-between">
                    <ng-multiselect-dropdown [placeholder]="'Select Payment Terms'" class=" flex-fill"
                      [settings]="paymentTermsDropdownSettings" [data]="allPaymentTerms" formControlName="paymentTerms"
                      id="paymentTerms" name="paymentTerms" required (onSelect)="onPaymentTermsSelect($event, 0)"
                      (onDeSelect)="onPaymentTermsDeSelect()">
                    </ng-multiselect-dropdown>
                    @if(showTextBox){
                    <input type="text" class="form-control w-150px ms-2" placeholder="Enter up to 3 digits"
                      formControlName="paymentTermsForOthers" maxlength="3" (keypress)="restrictToNumbers($event)">
                    }
                  </div>
                  @if(showDiscountMessage)
                  {
                  <small class="text-success">Customer is eligible for 1% discount.</small>
                  }
                </div>
                <div class="col-sm-4 mb-3">
                  <div class="d-flex justify-content-between">
                    <label class="form-text" for="address">Address:<span class="required">*</span></label>
                    @if (form.get('customerInfo.address')?.invalid && form.get('customerInfo.address')?.touched) {
                    <div class="text-danger">
                      <small>Required.</small>
                    </div>
                    }
                  </div>
                  <input formControlName="address" type="text" class="form-control" (input)="sanitizeInput('address')"
                  (keydown)="preventMultipleSpaces($event, 'address')"
                  (paste)="handlePaste($event, 'address')"/>
                </div>
                <div class="col-sm-4 mb-3">
                  <div class="d-flex justify-content-between">
                    <label class="form-text" for="city">City:<span class="required">*</span></label>
                    @if (form.get('customerInfo.city')?.invalid && form.get('customerInfo.city')?.touched) {
                    <div class="text-danger">
                      <small>Required.</small>
                    </div>
                    }
                  </div>
                  <input formControlName="city" type="text" class="form-control" (input)="sanitizeInput('city')"
                  (keydown)="preventMultipleSpaces($event, 'city')"
                  (paste)="handlePaste($event, 'city')"/>
                </div>
                <!-- <div class="col-sm-4 mb-3">
                  <div class="d-flex justify-content-between">
                    <label class="form-text" for="state">State/Province:<span class="required">*</span></label>
                    @if (form.get('customerInfo.state')?.invalid && form.get('customerInfo.state')?.touched) {
                    <div class="text-danger">
                      <small>Required.</small>
                    </div>
                    }
                  </div>
                  <input formControlName="state" type="text" class="form-control" (input)="sanitizeInput('state')"
                  (keydown)="preventMultipleSpaces($event, 'state')"
                  (paste)="handlePaste($event, 'state')" />
                </div> -->
                <div class="col-sm-4 mb-3">
                  <div class="d-flex justify-content-between">
                    <label class="form-text" for="postCode">Postal Code:<span class="required">*</span></label>
                    @if (form.get('customerInfo.postCode')?.invalid && form.get('customerInfo.postCode')?.touched) {
                    <div class="text-danger">
                      <small>Required.</small>
                    </div>
                    }
                  </div>
                  <input formControlName="postCode" type="text" class="form-control" />
                </div>
                <div class="col-sm-4 mb-3">
                  <div class="d-flex justify-content-between">
                    <label class="form-text" for="country">Country:<span class="required">*</span></label>
                    @if(countryValidationFlag){
                    <div class="text-danger">
                      <small>Required.</small>
                    </div>
                    }
                  </div>
                  <ng-multiselect-dropdown [placeholder]="'Select Country'" [settings]="countriesdropdownSettings"
                    [data]="allCountries" formControlName="country" id="country" name="country" required
                    (onSelect)="onCountrySelect($event, 0)" (onDeSelect)="onCountryDeSelect()">
                  </ng-multiselect-dropdown>
                </div>
              </div>
            </fieldset>
          </div>
          <!-- Point of Contacts Fields -->
          <fieldset formArrayName="pointOfContacts">
            <legend>Point Of Contacts</legend>
            <div *ngFor="let contact of pointOfContacts.controls; let i = index" [formGroupName]="i"
              class="mb-3 d-flex align-items-start contact-row">
              <!-- <label class="contact-label">{{ contactLabels[i] }}:</label> -->
              <!-- <label class="contact-label">{{ contactLabels[i].name }}:</label> 
              <label class="contact-label">
                {{ getContactLabelName(contact.get('PointOfContactType')?.value) }}:
          
              </label> -->
              <label class="contact-label">
                <ng-container *ngIf="isEditing; else displayStaticLabel">
                  {{ getContactLabelName(contact.get('PointOfContactType')?.value) }}:
                </ng-container>
                <ng-template #displayStaticLabel>
                  {{ contactLabels[i].name }}:
                </ng-template>
              </label>
              <!-- <label class="contact-label">{{ contact.get('contactType').value }}:</label> -->
              <div class="vertical-line"></div>
              <div class="flex-grow-1">
                <div class="row">
                  <div class="col-md-4 mb-2">
                    <input formControlName="name" placeholder="Name" type="text" class="form-control" (input)="sanitizeInput('name')"
                    (keydown)="preventMultipleSpaces($event, 'name')"
                    (paste)="handlePaste($event, 'name',i)" />
                    <div [class.text-danger]="form.get('contact.name')?.invalid && form.get('contact.name')?.touched">
                      <small
                        [style.display]="form.get('contact.name')?.invalid && form.get('contact.name')?.touched ? 'block' : 'none'">
                        Required.
                      </small>
                    </div>
                  </div>
                  <div class="col-md-4 mb-2">
                    <input formControlName="emailId" placeholder="Email ID" type="email" class="form-control" (input)="sanitizeInput('emailId')"
                    (keydown)="preventMultipleSpaces($event, 'emailId')"
                    (paste)="handlePaste($event, 'emailId', i)"/>
                    <!-- <div *ngIf="contact.get('emailId')?.touched && contact.get('emailId')?.invalid">
                      <small class="text-danger">Required.</small>
                    </div> -->
                    <div
                      [class.text-danger]="form.get('contact.emailId')?.invalid && form.get('contact.emailId')?.touched">
                      <small
                        [style.display]="form.get('contact.emailId')?.invalid && form.get('contact.emailId')?.touched ? 'block' : 'none'">
                        Required.
                      </small>
                      <small  class="text-danger"
                      [style.display]="(contact.get('emailId')?.hasError('email') || contact.get('emailId')?.hasError('invalidEmail')) && contact.get('emailId')?.touched ? 'block' : 'none'">
                        Invalid email format.
                      </small>
                    </div>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="row g-0">
                      <div class="col-6">
                        <ng-multiselect-dropdown [placeholder]="'Select Country'" [settings]="countrydropdownSettings"
                          [data]="allCountries" formControlName="countryID"
                          (onSelect)="onCountryCodePOCSelect($event, i)" (onDeSelect)="onCountryCodePOCDeSelect(i)">
                        </ng-multiselect-dropdown>
                        <!-- @if(countryCodeValidationFlag)
                        {
                        <div class="text-danger">
                          <small>Required.</small>
                        </div>
                        } -->
                        <div *ngIf="contact.get('countryID')?.hasError('required') && contact.get('countryID')?.touched"
                          class="text-danger">
                          <small>Country is required for {{ contactLabels[i].name }}.</small>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <input type="text" class="form-control ms-2" placeholder="Mobile Number" maxlength="12"
                          formControlName="mobileNumber" 
                          (keypress)="restrictToNumbers($event)" />
                        <div *ngIf="form.get('mobileNumber')?.touched && form.get('mobileNumber')?.invalid"
                          class="text-danger">
                          <small>Mobile Number is required.</small>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </fieldset>
          <div class="d-flex justify-content-end align-items-end">
            <!-- <button type="submit" class="btn btn-primary mt-3">Save</button> -->
            <button type="submit" class="btn btn-primary mt-3" [disabled]="form.get('customerInfo')?.invalid"
              (click)="saveAndAddAddress()">Save & Add
              Address</button>
          </div>
        </div>

        <!-- Tab 2: Address -->
        <div *ngIf="activeTab === 2">
          <div class="mb-3 d-flex justify-content-start">
            <a href="#" (click)="getCustomerPOCDetails($event)" class="text-primary text-decoration-underline">Copy
              Primary Address</a>
          </div>
          <div formArrayName="addressBook" class="mb-4">
            <div *ngFor="let addressGroup of addressBook.controls; let i = index" [formGroupName]="i">
              <fieldset>
                <legend>Address {{ i + 1 }}</legend>
                <div class="row">
                  <div class="col-sm-4 mb-3">
                    <div class="d-flex justify-content-between">
                      <label class="form-text" for="addressHeading">Address Heading:<span
                          class="required">*</span></label>
                      <div
                        *ngIf="addressGroup.get('addressHeading')?.invalid && addressGroup.get('addressHeading')?.touched">
                        <small class="text-danger">Required.</small>
                      </div>
                    </div>
                    <input formControlName="addressHeading" type="text" class="form-control" (input)="sanitizeInput('addressHeading',i)"
                    (keydown)="preventMultipleSpaces($event, 'addressHeading',i)"
                    (paste)="handlePaste($event, 'addressHeading',i)" />
                  </div>
                  <div class="col-sm-4 mb-3">
                    <div class="d-flex justify-content-between">
                      <label class="form-text" for="address">Address:<span class="required">*</span></label>
                      <div *ngIf="addressGroup.get('address')?.invalid && addressGroup.get('address')?.touched">
                        <small class="text-danger">Required.</small>
                      </div>
                    </div>
                    <input formControlName="address" type="text" class="form-control" />
                  </div>
                  <div class="col-sm-4 mb-3">
                    <div class="d-flex justify-content-between">
                      <label class="form-text" for="city">City:<span class="required">*</span></label>
                      <div *ngIf="addressGroup.get('city')?.invalid && addressGroup.get('city')?.touched">
                        <small class="text-danger">Required.</small>
                      </div>
                    </div>
                    <input formControlName="city" type="text" class="form-control" />
                  </div>
                  <!-- <div class="col-sm-4 mb-3">
                    <div class="d-flex justify-content-between">
                      <label class="form-text" for="state">State/Province:<span class="required">*</span></label>
                      <div *ngIf="addressGroup.get('state')?.invalid && addressGroup.get('state')?.touched">
                        <small class="text-danger">Required.</small>
                      </div>
                    </div>
                    <input formControlName="state" type="text" class="form-control"/>
                  </div> -->
                  <div class="col-sm-4 mb-3">
                    <div class="d-flex justify-content-between">
                      <label class="form-text" for="country">Country:<span class="required">*</span></label>
                      <!-- @if (form.get('addressGroup.countryID')?.invalid && form.get('addressGroup.countryID')?.touched)
                      {
                      <div class="text-danger">
                        <small>Required.</small>
                      </div>
                      } -->
                      <div
                        *ngIf="addressBook.at(i).get('countryID')?.invalid && addressBook.at(i).get('countryID')?.touched"
                        class="text-danger">
                        <small>Required.</small>
                      </div>
                    </div>
                    <ng-multiselect-dropdown [placeholder]="'Select Country'" [settings]="countriesdropdownSettings"
                      formControlName="countryID" [data]="allCountries" id="country" name="country" required
                      (onSelect)="onCountryAddressSelect($event, i)" (onDeSelect)="onCountryAddressDeSelect(i)">
                    </ng-multiselect-dropdown>
                  </div>
                  <div class="col-sm-4 mb-3">
                    <div class="d-flex justify-content-between">
                      <label class="form-text" for="postCode">Postal Code:<span class="required">*</span></label>
                      @if(addressGroup.get('postCode')?.invalid && addressGroup.get('postCode')?.touched){
                      <div class="text-danger">Required</div>
                      }
                    </div>
                    <input formControlName="postCode" type="text" class="form-control" />
                  </div>
                  <div class="col-sm-4 mb-3">
                    <div class="d-flex justify-content-between">
                      <label class="form-text" for="POCName">POC Name:<span class="required">*</span></label>
                      <div *ngIf="addressGroup.get('POCName')?.invalid && addressGroup.get('POCName')?.touched">
                        <small class="text-danger">Required.</small>
                      </div>
                    </div>
                    <input formControlName="POCName" type="text" class="form-control" (input)="sanitizeInput('POCName',i)"
                    (keydown)="preventMultipleSpaces($event, 'POCName',i)"
                    (paste)="handlePaste($event, 'POCName',i)" />
                  </div>
                  <div class="col-sm-4 mb-3">
                    <div class="d-flex justify-content-between">
                      <label class="form-text" for="POCEmail">POC Email:<span class="required">*</span></label>
                      <div *ngIf="addressGroup.get('POCEmail')?.invalid && addressGroup.get('POCEmail')?.touched">
                        <!-- <small class="text-danger">Required.</small> -->
                        <small *ngIf="addressGroup.get('POCEmail')?.hasError('required')" class="text-danger">Required.</small>
                        <small *ngIf="addressGroup.get('POCEmail')?.hasError('email') || addressGroup.get('POCEmail')?.hasError('invalidEmail')" class="text-danger">
                          Invalid email format.
                        </small>
                      </div>
                    </div>
                    <input formControlName="POCEmail" type="text" class="form-control" (input)="sanitizeInput('POCEmail',i)"
                    (keydown)="preventMultipleSpaces($event, 'POCEmail',i)"
                    (paste)="handlePaste($event, 'POCEmail',i)" />
                  </div>
                  <!-- <div class="col-sm-4 mb-3">
                    <div class="d-flex justify-content-between">
                      <label class="form-text" for="country">POC Country:<span class="required">*</span></label>
                      @if (form.get('addressGroup.POCCountryID')?.invalid &&
                      form.get('addressGroup.POCCountryID')?.touched) {
                      <div class="text-danger">
                        <small>Required.</small>
                      </div>
                      } 
                      <div
                        *ngIf="addressBook.at(i).get('POCCountryID')?.invalid && addressBook.at(i).get('POCCountryID')?.touched"
                        class="text-danger">
                        <small>Required.</small>
                      </div>
                    </div>
                    <ng-multiselect-dropdown [placeholder]="'Select Country'" [settings]="countrydropdownSettings"
                      formControlName="POCCountryID" [data]="allCountries" id="country" name="country" required
                      (onSelect)="onPOCCountryAddressSelect($event, i)"
                      (onDeSelect)="onPOCCountryAddressDeSelect($event, i)">
                    </ng-multiselect-dropdown>
                  </div> -->
                  <div class="col-md-4 mb-2">
                    <div class="row g-0">
                      <label for="POCMobile" class="form-text">POC Mobile:<span class="required">*</span></label>
                      <div class="col-6">
                        <ng-multiselect-dropdown [placeholder]="'Select Country'" [settings]="countrydropdownSettings"
                          [data]="allCountries" formControlName="CountryCode"
                          (onSelect)="onCountryCodeMobileAddressSelect($event, i)"
                          (onDeSelect)="onCountryCodeMobileAddressSelectDeSelect($event)">
                        </ng-multiselect-dropdown>
                        @if(countryCodeValidationFlag)
                        {
                        <div class="text-danger">
                          <small>Country is required.</small>
                        </div>
                        }
                      </div>
                      <div class="col-md-6">
                        <input type="text" class="form-control ms-2" placeholder="Mobile Number" minlength="8"
                          maxlength="12" (keypress)="restrictToNumbers($event)" formControlName="POCMobile" />
                        <div *ngIf="addressGroup.get('POCMobile')?.invalid && addressGroup.get('POCMobile')?.touched">
                          <small class="text-danger">POC Mobile is required.</small>
                          <small class="text-danger" *ngIf="addressGroup.get('POCMobile')?.hasError('minlength')">
                            Enter a minimum of 8 digits.
                          </small>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-4 mb-2">&nbsp;</div>
                  <!-- <a href="#" class="me-3 text-danger" data-bs-toggle="modal" data-bs-target="#delete-address-popup"     [ngStyle]="{'display': isEditing ? 'inline' : 'none'}"  
                       (click)="selectedAddressForDeletion(addressGroup.value); closeModal()" title="Delete Address"><i
                        class="material-symbols-outlined text-danger">delete</i></a> -->
                  <div class="d-flex justify-content-end">
                    <button class="btn btn-danger btn-sm mt-4 mb-4" data-bs-toggle="modal" data-bs-target="#delete-address-popup"
                      (click)="selectedAddressForDeletion(addressGroup.value, i);" [disabled]="i === 0" title="Delete Address">
                      Delete Address
                    </button>
                  </div>



                  <!-- <label for="POCMobile">POCCountry:<span class="required">*</span></label>
                  <input formControlName="POCCountryID" type="text" class="form-control" />
                  <div *ngIf="addressGroup.get('POCCountryID')?.invalid && addressGroup.get('POCCountryID')?.touched">
                     <small class="text-danger">POC Country is required.</small>
                   </div>
                 </div>-->
                </div>
              </fieldset>
            </div>
            <!--           <button type="button" class="btn btn-light mt-3" (click)="addAddress()">+ Add Address</button> -->

            <div class="d-flex justify-content-end align-items-end">
              <!-- <button type="button" class="btn btn-secondary mt-3" (click)="setActiveTab(1)">Back</button> -->
              <button type="button" class="btn btn-outline-primary me-3" (click)="addAddress()"  [disabled]="form.get('addressBook')?.invalid">+ Add Address</button>

              <button type="submit" class="btn btn-primary" (click)="saveAddresses()"
                [disabled]="form.get('addressBook')?.invalid">Save</button>
            </div>
          </div>
        </div>
        <!-- Tab 3: Transport & Packing -->
        <div *ngIf="activeTab === 3">
          <div formGroupName="locationForm" class="">
            <fieldset>
              <legend>Location</legend>
              <div class="row">
                <!-- All Locations Checkbox -->
                <div class="col-sm-12 mb-3">
                  <input type="checkbox" formControlName="allLocations" />
                  <label class="ms-2">All Location</label>
                </div>

                <!-- Individual Locations -->
                 <!-- Individual Locations Fix -->
                <div class="col-md-12 mb-3">
                  <div formArrayName="selectedLocations" class="row">
                    <div class="col-md-2 mb-3" *ngFor="let custAddress of customerAddressForTransportAndPacking; let idx = index">
                      <input type="checkbox" 
                            [formControlName]="idx"
                            (click)="loadTransportAndPackingDetailsForAnAddress(custAddress.addressID, idx)" />

                      <span class="ms-2" 
                            (click)="loadTransportAndPackingDetailsForAnAddress(custAddress.addressID, idx)"
                            [ngClass]="{'underline-text': isAddressAddedForTransportAndPacking(custAddress.addressID)}">
                        {{custAddress.addressHeading}}
                      </span>
                      <div class="ms-4 mb-0" 
                          (click)="loadTransportAndPackingDetailsForAnAddress(custAddress.addressID, idx)"
                          [ngClass]="{'underline-text': isAddressAddedForTransportAndPacking(custAddress.addressID)}">
                        <!-- {{custAddress.city}}, {{custAddress.state}} -->
                         {{custAddress.city}}
                      </div>
                      <div class="ms-4" 
                          (click)="loadTransportAndPackingDetailsForAnAddress(custAddress.addressID, idx)"
                          [ngClass]="{'underline-text': isAddressAddedForTransportAndPacking(custAddress.addressID) }">
                        {{custAddress.postCode}}
                      </div>
                    </div>
                  </div>
                  <div class="row text-end">
                    <label><i class="bi bi-info-circle"></i> Click on address to view or edit</label>
                  </div>
                </div>
              </div>
            </fieldset>
          </div>
          <!-- Transport Fields -->
          <div formGroupName="transportInfo" class="">
            <fieldset>
              <legend>Transport</legend>
              <div class="row">
                <div class="col-md-12 mb-3">
                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label class="form-text" for="incotermID">Incoterm<span class="required">*</span></label>
                      <ng-multiselect-dropdown [placeholder]="'Select Incoterm'" [settings]="incotermdropdownSettings"
                        [data]="allIncoterms" (onSelect)="onIncotermSelect($event)"
                        (onDeSelect)="onIncotermDeSelect($event)" formControlName="incoterm" id="incotermID"
                        name="incotermID" required>
                      </ng-multiselect-dropdown>

                      @if(incotermValidationFlag)
                      {
                      <div class="text-danger">
                        <small>Required.</small>
                      </div>
                      }
                    </div>

                    <div class="col-md-6 mb-3">
                      <label class="form-text" for="maxPalletHeight">Max pallet height for Customer Warehouse (M)<span
                          class="required">*</span></label>

                      <div class="input-group mb-0">
                        <input type="text" class="form-control" formControlName="maxPalletHeight" placeholder=""
                          id="maxPalletHeight" name="maxPalletHeight" required
                          (keypress)="restrictToNumbersWithCommaAndPoint($event)">
                        <span class="input-group-text">Meter</span>

                      </div>
                      @if (form.get('transportInfo.maxPalletHeight')?.invalid &&
                      form.get('transportInfo.maxPalletHeight')?.touched) {
                      <div class="text-danger">
                        <small>Required.</small>
                      </div>
                      }
                    </div>
                    <div class="col-md-6 mb-3">
                      <label class="form-text" for="typeOfPalletID">Type of pallet<span
                          class="required">*</span></label>
                      <ng-multiselect-dropdown [placeholder]="'Select Pallet Type'"
                        [settings]="palletTypedropdownSettings" [data]="allTypesOfPallet"
                        (onSelect)="onTypeOfPalletSelect($event)" (onDeSelect)="onTypeOfPalletDeSelect($event)"
                        formControlName="typeOfPallet" id="typeOfPalletID" name="typeOfPalletID" required>
                      </ng-multiselect-dropdown>
                      @if(typeOfPalletValidationFlag)
                      {
                      <div class="text-danger">
                        <small>Required.</small>
                      </div>
                      }
                    </div>
                    <div class="col-md-6 mb-3">
                      <label class="form-text" for="pricingTypeID">Pricing type<span class="required">*</span></label>
                      <ng-multiselect-dropdown [placeholder]="'Select Pricing Type'"
                        [settings]="pricingTypedropdownSettings" [data]="allPricingTypes"
                        (onSelect)="onPricePalletSelect($event)" (onDeSelect)="onPricePalletDeSelect($event)"
                        formControlName="pricingType" id="pricingTypeID" name="pricingTypeID" required>
                      </ng-multiselect-dropdown>
                      @if(pricePalletValidationFlag)
                      {
                      <div class="text-danger">
                        <small>Required.</small>
                      </div>
                      }
                    </div>
                    @if(showNoOfPalletTextBox){
                    <div class="col-md-6 mb-3">
                      <label class="form-text" for="noOfPallet">No. of Pallet<span class="required">*</span></label>
                      <input type="text" class="form-control" formControlName="noOfPallet"
                        (ngModelChange)="clearAllTransportationCostFields()" minlength="1" maxlength="2" id="noOfPallet"
                        name="noOfPallet" min="1" placeholder={{placeholderForNoOfPalletField}}
                        onkeypress="return (event.charCode !=8 && event.charCode == 0 || (event.charCode >= 48 && event.charCode <= 57))">
                      @if (form.get('transportInfo.noOfPallet')?.invalid &&
                      form.get('transportInfo.noOfPallet')?.touched) {
                      <div class="text-danger">
                        <small *ngIf="form.get('transportInfo.noOfPallet')?.errors?.['required']">Required.</small>
                        <small *ngIf="form.get('transportInfo.noOfPallet')?.errors?.['min']">Value must be at least
                          1.</small>
                      </div>
                      }
                    </div>
                    }
                    <div class="col-md-6 mb-3">
                      <label class="form-text" for="noOfPallet">First loading time</label>
                      <input type="time" class="form-control" formControlName="firstLoadingTime">
                      <!-- @if (form.get('transportInfo.firstLoadingTime')?.invalid &&
                      form.get('transportInfo.firstLoadingTime')?.touched) {
                      <div class="text-danger">
                        <small *ngIf="form.get('transportInfo.firstLoadingTime')?.errors?.['required']">Required.</small>
                       
                      </div>
                      } -->

                    </div>
                    <div class="col-md-6 mb-3">
                      <label class="form-text" for="noOfPallet">Last loading time</label>
                      <input type="time" class="form-control" formControlName="lastLoadingTime">
                      <!-- @if (form.get('transportInfo.lastLoadingTime')?.invalid &&
                      form.get('transportInfo.lastLoadingTime')?.touched) {
                      <div class="text-danger">
                        <small *ngIf="form.get('transportInfo.lastLoadingTime')?.errors?.['required']">Required.</small>
                       
                      </div>
                      } -->

                    </div>
                    <!-- @if(!isAnyAddressSelected){
                    <div class="col-md-6 mb-3">
                      <label class="form-text" for="transportationCost">Transportation cost<span
                          class="required">*</span></label>
                      <input type="text" class="form-control" formControlName="transportationCost"
                        id="transportationCost" name="transportationCost"
                        (keypress)="restrictToNumbersWithCommaAndPoint($event)">
                      @if (form.get('transportInfo.transportationCost')?.invalid &&
                      form.get('transportInfo.transportationCost')?.touched) {
                      <div class="text-danger">
                        <small>Required.</small>
                      </div>
                      }
                    </div>
                    } -->
                    <!-- @if(showPriceTextBox){
                      <div class="col-md-6 mb-3"> 
                        <label for="price">Price<span class="required">*</span></label>
                        <input type="text" class="form-control" formControlName="price" id="price" name="price"  onkeypress="return (event.charCode !=8 && event.charCode == 0 || (event.charCode >= 48 && event.charCode <= 57))" >
                        @if (form.get('transportInfo.price')?.invalid &&
                        form.get('transportInfo.price')?.touched) {
                        <div class="text-danger">
                          <small>Required.</small>
                        </div>
                        }
                      </div>
                   } -->
                    <div class="row">
                      <div class="col-md-12">
                        @if(transportCosts.controls.length > 0){
                        <div class="d-flex align-items-center">
                          <h6>Transportation Cost</h6>
                        
                          @if(showCalculateTransportationButton()){
                          <button type="button" class="btn btn-primary btn-sm ms-2"
                            (click)="fetchTransportationCostForSelectedLocations()"> <i class="bi bi-calculator"></i>
                            Calculate Transportation Cost</button>
                          }
                        </div>

                        <div formArrayName="transportCosts" class="d-flex col-md-12 flex-wrap">
                          <div *ngFor="let costCtrl of transportCosts.controls; let i = index" [formGroupName]="i"
                            class="mb-3 me-3">
                            <div class="d-flex align-items-center">
                               <div class="form-text me-2 align-self-center ">Postal code: </div>
                            <label class="me-2 align-self-end fs-6">{{ getPostCodeByAddressID(costCtrl.get('addressID')?.value) }}</label>
                            </div>
                           
                            <input type="text" (keypress)="restrictToNumbersWithCommaAndPoint($event)"
                              formControlName="transportationCost" class="form-control me-3"
                              placeholder="Enter Transportation cost" />
                            <div
                              *ngIf="costCtrl.get('transportationCost')?.invalid && costCtrl.get('transportationCost')?.touched"
                              class="text-danger">
                              <small>Required.</small>
                            </div>


                          </div>
                        </div>
                        }
                      </div>
                    </div>
                    @if(showTransportAndPackingInfoMessage){
                    <div class="row text-end">
                      <label><i class="bi bi-info-circle"></i> Transport and Packing Details are not same for all the
                        selected locations </label>
                    </div>
                    }

                  </div>


                </div>

              </div>
            </fieldset>
          </div>
          <!-- Packing Fields -->
          <div formGroupName="packingInfo" class="">
            <fieldset>
              <legend>Packing</legend>
              <!-- <div class="row">
                <div class="d-flex justify-content-end align-items-center mb-2 gap-2">
                  <label for="packingCost" class="mb-0">Total Packing Cost</label>
                  <input type="text" class="form-control w-auto"  required formControlName="packingCost" id="packingCost" name="packingCost">
                  @if (form.get('packingInfo.packingCost')?.invalid &&
                        form.get('packingInfo.packingCost')?.touched) {
                        <div class="text-danger">
                          <small>Required.</small>
                        </div>
                  }
                </div>
              </div> -->
              <div class="row">
                <div class="col-md-12 mb-3">
                  <div class="row">
                    <div class="col-md-3 mb-3">
                      <label class="form-text" for="typeOfPackingID">Type of boxes<span class="required">*</span></label>
                      <ng-multiselect-dropdown [placeholder]="'Select Box Type'"
                        [settings]="packingTypedropdownSettings" [data]="allTypesOfPacking"
                        formControlName="packingType" (onSelect)="onPackingTypeSelect($event)"
                        (onDeSelect)="onPackingTypeDeSelect($event)" id="typeOfPackingID" name="typeOfPackingID"
                        required>
                      </ng-multiselect-dropdown>
                      @if(packingTypeValidationFlag)
                      {
                      <div class="text-danger">
                        <small>Required.</small>
                      </div>
                      }
                    </div>
                    @if(showNoOfPiecesPerRow){
                    <div class="col-md-3 mb-3">
                      <label class="form-text" for="">No. of pieces per row<span class="required">*</span></label>
                      <input type="text" class="form-control" formControlName="noOfPiecesPerRow"
                        (keyup)="calculateNoOfBoxes()"
                        onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))"
                        placeholder="">
                      @if (form.get('packingInfo.noOfPiecesPerRow')?.invalid &&
                      form.get('packingInfo.noOfPiecesPerRow')?.touched) {
                      <div class="text-danger">
                        <small>Required.</small>
                      </div>
                      }
                    </div>
                    }
                    @if(showNoOfRowsOnTop){
                    <div class="col-md-3 mb-3">
                      <label class="form-text" for="">No. of rows on top<span class="required">*</span></label>
                      <input type="text" class="form-control" formControlName="noOfRowsOnTop"
                        (keyup)="calculateNoOfBoxes()"
                        onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))"
                        placeholder="">
                      @if (form.get('packingInfo.noOfRowsOnTop')?.invalid &&
                      form.get('packingInfo.noOfRowsOnTop')?.touched) {
                      <div class="text-danger">
                        <small>Required.</small>
                      </div>
                      }
                    </div>
                    }
                    <div class="col-md-3 mb-3">
                      <label class="form-text" for="">No. of boxes per pallet<span class="required">*</span></label>
                      <input type="text" class="form-control" formControlName="noOfBoxesPerPallet"
                        onkeypress="return (event.charCode !=8 && event.charCode ==0 || (event.charCode >= 48 && event.charCode <= 57))"
                        placeholder="">
                      @if (form.get('packingInfo.noOfBoxesPerPallet')?.invalid &&
                      form.get('packingInfo.noOfBoxesPerPallet')?.touched) {
                      <div class="text-danger">
                        <small>Required.</small>
                      </div>
                      }
                    </div>
                    <!-- Static Packing Options Starts Here-->
                    <div class="col-md-12 d-flex justify-content-between m-2">
                      <!-- @if(showCardboardLayerPadCheckbox){
                        <div class="col-md-3 mb-3"> 
                          <input type="checkbox" formControlName="isCardboardLayerPad" /> Cardboard layer pad (2 per pallet)
                        </div>
                      }
                      @if(showPlasticBigBoxCheckbox){
                        <div class="col-md-3 mb-3"> 
                          <input type="checkbox" formControlName="isPlasticBagForBigBox" /> Plastic Bag for big box
                        </div>
                      }
                      
                      @if(show1By8PalletBagCheckbox){
                        <div class="col-md-3 mb-3"> 
                          <input type="checkbox" formControlName="is1By8PalletBag" /> 1/8 Pallet Bag
                        </div>
                      }
                      @if(showDoubleStackedCheckbox){
                        <div class="col-md-3 mb-3"> 
                          <input type="checkbox" formControlName="isDoubleStacked" /> Double Stacked
                        </div>
                      } -->
                      <div class="col-md-12">
                        <div formArrayName="packingOptions">
                          <div class="row gy-2">
                            <div *ngFor="let option of allPackingTypes; let i = index" class="col-md-4">

                              <input type="checkbox" [formControlName]="i" (change)="onCheckboxChange2($event, i)" />
                              <span class="ms-2 form-check-label">{{ option.packingType }}</span>

                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- Static Packing Options Ends Here-->
                    <!-- Dynamic Packing Options Starts Here -->
                    <!-- <div class="col-md-12 m-2">
                      
                      <div formArrayName="packingOptions">
                        <div class="row gy-2">
                          <div *ngFor="let option of allPackingTypes; let i = index" [formGroupName]="i" class="col-md-6">
                            
                              <input type="checkbox" formControlName="checked" (change)="onCheckboxChange(i, $event)" />
                              <span class="ms-2 form-check-label">{{ option.packingType }}</span>
                              <input
                                type="text"
                                class="form-control cost-input"
                                formControlName="cost"
                                placeholder="Cost"
                                class="packing-type-cost"
                                (keyup)="calculatePackingCost()"
                                >
                            
                            
                          </div>
                        </div>  
                      </div>
                    </div>   -->
                    <!-- Dynamic Packing Options Ends Here-->

                  </div>
                </div>

              </div>
            </fieldset>
          </div>
          <div class="d-flex justify-content-end align-items-end">
            <!-- <button type="submit" class="btn btn-primary mt-3">Save</button> -->
            <button type="button" class="btn btn-danger mt-3 me-3" data-bs-dismiss="offcanvas"
              (click)="resetForm()">Cancel</button>
            <button type="button" class="btn btn-primary mt-3" id="save-transport-packing-btn" data-bs-dismiss="offcanvas"
              [disabled]="form.get('transportInfo')?.invalid || form.get('packingInfo')?.invalid || (!isAnyAddressSelected && selectedAddressIDToViewTPDetails === '')"
              (click)="saveTransportAndPackingDetails()">Save</button>
            <!--form.get('locationForm')?.invalid || form.get('transportInfo')?.invalid || form.get('packingInfo')?.invalid || !getSelectedAddressIDsForTransportAndPacking()-->
          </div>
        </div>
      </form>
    </div>
  </div>
  <!-- Delete Customer Modal -->
  <div class="modal fade" id="delete-popup" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"
    data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Delete Customer</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          
          <p class="">Are you sure, you want to delete this Customer?</p>
          @if(isQuoteAssociated) {
            <p class="text-danger">There is a Customer RFQ/Quotation associated with this Customer.</p>

            <small class="text-danger">Note: All the Quotations associated to this customer will be non-editable.</small>
          }
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-danger" data-bs-dismiss="modal" (click)="confirmDelete()">Delete</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Delete Address Modal -->
  <div class="modal fade" id="delete-address-popup" tabindex="-1" aria-labelledby="deleteAddressModalLabel"
    aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteAddressModalLabel">Delete Address</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
         
          <p>Are you sure, you want to delete this address?</p>
          @if(isAddressAssociated) {
            <p class="text-danger">There is Transport and Packing data associated with this Address.</p>
            <small class="text-danger">Note: This action will make the associated Quotation non-editable.</small>
          }
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" data-bs-dismiss="modal" (click)="onDelete()">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Update Customer Status Modal -->
  <div class="modal fade" id="update-status-popup" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"
    data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Update Customer Status</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
            (click)="cancelUpdate()"></button>
        </div>
        <div class="modal-body">
          <p class="">Are you sure, you want to {{selectedCustomer?.isEnabled ? "disable" : "enable"}} this customer?</p>
          @if(isQuoteAssociated) {
            <p class="text-danger">There is a Customer RFQ/Quotation associated with this Customer.</p>
            <small class="text-danger">Note: All the Quotations associated to this customer will be non-editable.</small>
          }
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
            (click)="cancelUpdate()">Cancel</button>
          <button type="submit" class="btn btn-primary"
            [class]="!selectedCustomer?.isEnabled  ? 'btn-primary' : 'btn-danger'"
            (click)="confirmUpdateStatus()">{{selectedCustomer?.isEnabled ? "Disable" : "Enable"}}</button>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Update Transportation Cost To Zero-->
<div class="modal fade" id="update-transportation-cost-to-zero-popup" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"><i class="bi bi-exclamation-octagon text-warning"></i> Alert</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p class="">This postal code is associated with transportation costs. Any changes will require transportation costs to be recalculated.
                </p>
                 <div>
                    Do you want to proceed? 
                  </div>
                <div class="text-danger mt-2">Note: This action will set the transportation cost to zero for those addresses where country or postal code is modified.</div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" 
                    data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-danger" id="confirm-update-transport-cost"
                    data-bs-dismiss="modal">Update</button>
            </div>
        </div>
    </div>
</div>
<!-- Customer Details Modal -->
<!-- offcanvas -->
<div class="offcanvas offcanvas-end w-80 fade" id="user-details-modal" tabindex="-1" data-bs-backdrop="static"
  data-bs-keyboard="false">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title mx-3" id="exampleModalLabel">Customer Details</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body nofooter">
    <ul role="tablist" class="nav nav-pills mb-4 nav-fill">
      <li role="presentation" class="nav-item waves-effect waves-light"><a class="nav-link active" data-bs-toggle="tab"
          href="#customerDetails">Customer Details</a></li>
      <li role="presentation" class="nav-item waves-effect waves-light"><a class="nav-link" data-bs-toggle="tab"
          href="#addressBook">Address Book</a></li>
      <li role="presentation" class="nav-item waves-effect waves-light"><a class="nav-link" data-bs-toggle="tab"
          href="#transport&Packing">Transport & Packing</a></li>
    </ul>
    <div class="tab-content">
 
      <div class="tab-pane active" id="customerDetails" *ngIf="customerDisplay">
        <!-- <fieldset class="mt-3"> -->
        <!-- <h6 class="text-primary">Details</h6> -->
        <div class="row">
          <div class="col-md-4 mb-2">
            <div class="form-text">Customer Name</div>
            <label class="form-label">{{ customerDisplay.companyName ? customerDisplay.companyName : 'Not Available'
              }}</label>
          </div>
          <div class="col-md-4 mb-2">
            <div class="form-text">Customer Type</div>
            <label class="form-label">{{ customerDisplay.customerType ? customerDisplay.customerType : 'Not Available'
              }}</label>
          </div>
          <div class="col-md-4 mb-2">
            <div class="form-text">Payment Terms</div>
            <label class="form-label">{{ customerDisplay.paymentTerm ? customerDisplay.paymentTerm : 'Not Available'
              }}</label>
          </div>
          <div class="col-md-4 mb-2">
            <div class="form-text">Postal Code</div>
            <label class="form-label">{{ customerDisplay.postCode ? customerDisplay.postCode : 'Not Available'
              }}</label>
          </div>
          <div class="col-md-4 mb-2">
            <div class="form-text">Country</div>
            <label class="form-label">{{ customerDisplay.country ? customerDisplay.country : 'Not Available'
              }}</label>
          </div>
        </div>
        <!-- </fieldset> -->
        <!-- <fieldset> -->
        <h6 class="text-primary mt-4">Point of Contact</h6>
        <div class="row">
          <div class="col-md-4 mb-2">
            <div class="form-text">Primary Telephone</div>
            <label class="form-label">{{ customerDisplay.mobileNumber ? customerDisplay.mobileNumber : 'Not Available'
              }}</label>
          </div>
          <div class="col-md-4 mb-2">
            <div class="form-text">Primary Email ID</div>
            <label class="form-label">{{ customerDisplay.emailID ? customerDisplay.emailID : 'Not Available'
              }}</label>
          </div>
          <div class="col-md-4 mb-2">
            <div class="form-text">Sales Email ID</div>
            <label class="form-label">{{ customerDisplay.pocSales ? customerDisplay.pocSales : 'Not Available'
              }}</label>
          </div>
          <div class="col-md-4 mb-2">
            <div class="form-text">Invoice Email ID</div>
            <label class="form-label">{{ customerDisplay.pocInvoice ? customerDisplay.pocInvoice : 'Not Available'
              }}</label>
          </div>
          <div class="col-md-4 mb-2">
            <div class="form-text">Purchase Email ID</div>
            <label class="form-label">{{ customerDisplay.pocPurchase ? customerDisplay.pocPurchase : 'Not Available'
              }}</label>
          </div>
        </div>
        <!-- </fieldset> -->
      </div>
      <div class="tab-pane fade" id="addressBook">
        <div class="row">
          <!-- Loop through each address and create a block for it -->
          <div class="col-md-4 mb-2" *ngFor="let addr of addressesdetails; let i = index">
            <!--  <div class="form-text"><strong>Address {{ i + 1 }}</strong></div> -->
            <address class="mb-4">
              <h6 class="text-primary">{{addr.addressHeading ? addr.addressHeading : 'Not Available'}}</h6>
              <div class="form-label">{{addr.address ? addr.address : 'Not Available'}}</div>
              <div class="form-label">{{addr.city ? addr.city : 'Not Available'}}</div>
      <!--      // <div class="form-label">{{addr.state ? addr.state : 'Not Available'}}</div> -->
              <div class="form-label">{{addr.country ? addr.country : 'Not Available'}}</div>
              <div class="form-label">{{addr.postCode ? addr.postCode : 'Not Available'}}</div>
            </address>
            <h6 class="text-primary">Point of Contact</h6>
            <address>
              <div class="form-label">{{addr.pocName ? addr.pocName : 'Not Available'}}</div>
              <div class="form-label">{{addr.pocEmail }} {{addr.pocName ? addr.pocName : 'Not Available'}}</div>
              <div class="form-label">{{addr.pocCountry ? addr.pocCountry : 'Not Available'}}</div>
              <div class="form-label">{{addr.pocMobile ? addr.pocMobile : 'Not Available'}}</div>
            </address>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="transport&Packing">
        <div class="accordion" id="accordiontransport&Packing">
          <div class="accordion-item" *ngFor="let addr of addressesdetails; let i = index">
            <h2 class="accordion-header" [id]="'heading' + i">
              <button 
              class="accordion-button collapsed" 
              type="button" 
              data-bs-toggle="collapse" 
              [attr.data-bs-target]="'#collapse' + i" 
              aria-expanded="false" 
              [attr.aria-controls]="'collapse' + i">
              {{ addr.addressHeading }} {{ addr.city }} {{ addr.state }} {{ addr.postCode }}
            </button>
            </h2>
            <div 
            [id]="'collapse' + i" 
            class="accordion-collapse collapse" 
            data-bs-parent="#accordiontransport&Packing"
            [attr.aria-labelledby]="'heading' + i">
              <div class="accordion-body">
                <!-- Transport Section -->
                <h6 class="text-primary">Transport</h6>
                <div class="row">
                  <div class="col-md-4 mb-2">
                    <div class="form-text">Incoterm</div>
                    <label class="form-label">{{ addr.incoterm || 'Not Available' }}</label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">Max pallet height for Customer Warehouse (M)</div>
                    <label class="form-label">{{ addr.maxPalletHeight || 'Not Available' }}</label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">Type Of Pallet</div>
                    <label class="form-label">{{ addr.typeOfPallet || 'Not Available' }}</label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">Pricing Type</div>
                    <label class="form-label">{{ addr.pricingType || 'Not Available' }}</label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">No. of Pallets</div>
                    <label class="form-label">{{ addr.noOfPallets || 'Not Available' }}</label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">First loading time</div>
                    <label class="form-label">{{ addr.firstLoadingTime ? formatTimeToLocal(addr.firstLoadingTime) : 'Not Available' }}</label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">Last loading time</div>
                    <label class="form-label">{{ addr.lastLoadingTime ? formatTimeToLocal(addr.lastLoadingTime) : 'Not Available' }}</label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">Transportation Cost</div>
                    <label class="form-label">{{ addr.transportationCost || 'Not Available' }}</label>
                  </div>
                </div>
      
                <hr>
      
                <!-- Packing Section -->
                <h6 class="text-primary">Packing</h6>
                <div class="row">
                  <div class="col-md-4 mb-2">
                    <div class="form-text">Type Of Boxes</div>
                    <label class="form-label">{{ addr.typeOfPacking || 'Not Available' }}</label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">No. of pieces per row</div>
                    <label class="form-label">{{ addr.noOfPiecesPerRow || 'Not Available' }}</label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">No. of rows on top</div>
                    <label class="form-label">{{ addr.noOfRowOnTop || 'Not Available' }}</label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">No. of boxes per pallet</div>
                    <label class="form-label">{{ addr.noOfBoxesPerPallet || 'Not Available' }}</label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">Cardboard layer pad (2 per pallet)</div>
                    <label class="form-label">
                      {{ addr.isCardboardLayerPad?.toLowerCase() === 'true' ? 'Yes' : 'No' }}
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">Plastic big bag for big box</div>
                    <label class="form-label">
                      {{ addr.isPlasticBagForBigBox?.toLowerCase() === 'true' ? 'Yes' : 'No' }}
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">1/8 pallet bag</div>
                    <label class="form-label">
                      {{ addr.is1By8PalletBag?.toLowerCase() === 'true' ? 'Yes' : 'No' }}
                    </label>
                  </div>
                  <div class="col-md-4 mb-2">
                    <div class="form-text">Double Stacked</div>
                    <label class="form-label">
                      {{ addr.isDoubleStacked?.toLowerCase() === 'true' ? 'Yes' : 'No' }}
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- </div> -->
      <div class="container-fluid">
        <div class="row gy-5">
          <!--profile picture section in square box and rounded placeholder with add picture label-->
          <div class="col-sm-3">


          </div>
          <div class="col-sm-9">

          </div>

        </div>
      </div>

    </div>
  </div>